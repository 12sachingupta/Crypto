"use strict";(globalThis.webpackChunk_wigwam_app=globalThis.webpackChunk_wigwam_app||[]).push([[163],{6063:(e,t,n)=>{n.d(t,{Z:()=>k});var o=n(17187),r=n.n(o),i=n(25532),s=n(28716),c=n(48764).Buffer,a=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{a(o.next(e))}catch(e){i(e)}}function c(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))};class d{constructor({context:e,logType:t}={}){this.exchangeTimeout=3e4,this.unresponsiveTimeout=15e3,this.deviceModel=null,this._events=new(r()),this.send=(e,t,n,o,r=c.alloc(0),s=[i.WC.OK],{abortTimeoutMs:d}={})=>a(this,void 0,void 0,(function*(){const a=this.tracer.withUpdatedContext({function:"send"});if(r.length>=256)throw a.trace("data.length exceeded 256 bytes limit",{dataLength:r.length}),new i.PS("data.length exceed 256 bytes limit. Got: "+r.length,"DataLengthTooBig");a.trace("Starting an exchange",{abortTimeoutMs:d});const u=yield this.exchange(c.concat([c.from([e,t,n,o]),c.from([r.length]),r]),{abortTimeoutMs:d});a.trace("Received response from exchange");const l=u.readUInt16BE(u.length-2);if(!s.some((e=>e===l)))throw new i.rZ(l);return u})),this._appAPIlock=null,this.tracer=new s.O$(null!==t&&void 0!==t?t:"transport",e)}exchange(e,{abortTimeoutMs:t}={}){throw new Error("exchange not implemented")}exchangeBulk(e,t){let n=!1;return(()=>a(this,void 0,void 0,(function*(){if(!n)for(const o of e){const e=yield this.exchange(o);if(n)return;const r=e.readUInt16BE(e.length-2);if(r!==i.WC.OK)throw new i.rZ(r);t.next(e)}})))().then((()=>!n&&t.complete()),(e=>!n&&t.error(e))),{unsubscribe:()=>{n=!0}}}setScrambleKey(e){}close(){return Promise.resolve()}on(e,t){this._events.on(e,t)}off(e,t){this._events.removeListener(e,t)}emit(e,...t){this._events.emit(e,...t)}setDebugMode(){}setExchangeTimeout(e){this.exchangeTimeout=e}setExchangeUnresponsiveTimeout(e){this.unresponsiveTimeout=e}static create(e=3e3,t){return new Promise(((n,o)=>{let r=!1;const s=this.listen({next:t=>{r=!0,s&&s.unsubscribe(),c&&clearTimeout(c),this.open(t.descriptor,e).then(n,o)},error:e=>{c&&clearTimeout(c),o(e)},complete:()=>{c&&clearTimeout(c),r||o(new i.PS(this.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),c=t?setTimeout((()=>{s.unsubscribe(),o(new i.PS(this.ErrorMessage_ListenTimeout,"ListenTimeout"))}),t):null}))}exchangeAtomicImpl(e){return a(this,void 0,void 0,(function*(){const t=this.tracer.withUpdatedContext({function:"exchangeAtomicImpl"});if(t.trace("Starting an atomic APDU exchange",{unresponsiveTimeout:this.unresponsiveTimeout}),this.exchangeBusyPromise)throw t.trace("Atomic exchange is already busy"),new i.wp("An action was already pending on the Ledger device. Please deny or reconnect.");let n;const o=new Promise((e=>{n=e}));this.exchangeBusyPromise=o;let r=!1;const s=setTimeout((()=>{t.trace('Timeout reached, emitting Transport event "unresponsive"',{unresponsiveTimeout:this.unresponsiveTimeout}),r=!0,this.emit("unresponsive")}),this.unresponsiveTimeout);try{const n=yield e();return r&&(t.trace("Device was unresponsive, emitting responsive"),this.emit("responsive")),n}finally{t.trace("Finalize, clearing busy guard"),clearTimeout(s),n&&n(),this.exchangeBusyPromise=null}}))}decorateAppAPIMethods(e,t,n){for(const o of t)e[o]=this.decorateAppAPIMethod(o,e[o],e,n)}decorateAppAPIMethod(e,t,n,o){return(...r)=>a(this,void 0,void 0,(function*(){const{_appAPIlock:s}=this;if(s)return Promise.reject(new i.PS("Ledger Device is busy (lock "+s+")","TransportLocked"));try{return this._appAPIlock=e,this.setScrambleKey(o),yield t.apply(n,r)}finally{this._appAPIlock=null}}))}setTraceContext(e){this.tracer=this.tracer.withContext(e)}updateTraceContext(e){this.tracer.updateContext(e)}getTraceContext(){return this.tracer.getContext()}}d.ErrorMessage_ListenTimeout="No Ledger device found (timeout)",d.ErrorMessage_NoDeviceFound="No Ledger device found";const u=d;var l={},h={},p=function(e,t){h[e]=t},g=function(e){var t=function(t,n){Object.assign(this,n),this.name=e,this.message=t||e,this.stack=(new Error).stack};return t.prototype=new Error,l[e]=t,t};g("AccountNameRequired"),g("AccountNotSupported"),g("AmountRequired"),g("BluetoothRequired"),g("BtcUnmatchedApp"),g("CantOpenDevice"),g("CashAddrNotSupported"),g("CurrencyNotSupported"),g("DeviceAppVerifyNotSupported"),g("DeviceGenuineSocketEarlyClose"),g("DeviceNotGenuine"),g("DeviceOnDashboardExpected"),g("DeviceOnDashboardUnexpected"),g("DeviceInOSUExpected"),g("DeviceHalted"),g("DeviceNameInvalid"),g("DeviceSocketFail"),g("DeviceSocketNoBulkStatus"),g("DisconnectedDevice"),g("DisconnectedDeviceDuringOperation"),g("EnpointConfig"),g("EthAppPleaseEnableContractData"),g("FeeEstimationFailed"),g("FirmwareNotRecognized"),g("HardResetFail"),g("InvalidXRPTag"),g("InvalidAddress"),g("InvalidAddressBecauseDestinationIsAlsoSource"),g("LatestMCUInstalledError"),g("UnknownMCU"),g("LedgerAPIError"),g("LedgerAPIErrorWithMessage"),g("LedgerAPINotAvailable"),g("ManagerAppAlreadyInstalled"),g("ManagerAppRelyOnBTC"),g("ManagerAppDepInstallRequired"),g("ManagerAppDepUninstallRequired"),g("ManagerDeviceLocked"),g("ManagerFirmwareNotEnoughSpace"),g("ManagerNotEnoughSpace"),g("ManagerUninstallBTCDep"),g("NetworkDown"),g("NoAddressesFound"),g("NotEnoughBalance"),g("NotEnoughBalanceToDelegate"),g("NotEnoughBalanceInParentAccount"),g("NotEnoughSpendableBalance"),g("NotEnoughBalanceBecauseDestinationNotCreated"),g("NoAccessToCamera"),g("NotEnoughGas"),g("NotSupportedLegacyAddress"),g("GasLessThanEstimate"),g("PasswordsDontMatch"),g("PasswordIncorrect"),g("RecommendSubAccountsToEmpty"),g("RecommendUndelegation"),g("TimeoutTagged"),g("UnexpectedBootloader"),g("MCUNotGenuineToDashboard"),g("RecipientRequired"),g("UnavailableTezosOriginatedAccountReceive"),g("UnavailableTezosOriginatedAccountSend"),g("UpdateFetchFileFail"),g("UpdateIncorrectHash"),g("UpdateIncorrectSig"),g("UpdateYourApp"),g("UserRefusedDeviceNameChange"),g("UserRefusedAddress"),g("UserRefusedFirmwareUpdate"),g("UserRefusedAllowManager"),g("UserRefusedOnDevice"),g("TransportOpenUserCancelled"),g("TransportInterfaceNotAvailable"),g("TransportRaceCondition"),g("TransportWebUSBGestureRequired"),g("DeviceShouldStayInApp"),g("WebsocketConnectionError"),g("WebsocketConnectionFailed"),g("WrongDeviceForAccount"),g("WrongAppForCurrency"),g("ETHAddressNonEIP"),g("CantScanQRCode"),g("FeeNotLoaded"),g("FeeRequired"),g("FeeTooHigh"),g("SyncError"),g("PairingFailed"),g("GenuineCheckFailed"),g("LedgerAPI4xx"),g("LedgerAPI5xx"),g("FirmwareOrAppUpdateRequired"),g("NoDBPathGiven"),g("DBWrongPassword"),g("DBNotReset");function v(e,t){this.name="TransportError",this.message=e,this.stack=(new Error).stack,this.id=t}v.prototype=new Error,p("TransportError",(function(e){return new v(e.message,e.id)}));var m={PIN_REMAINING_ATTEMPTS:25536,INCORRECT_LENGTH:26368,MISSING_CRITICAL_PARAMETER:26624,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,SECURITY_STATUS_NOT_SATISFIED:27010,CONDITIONS_OF_USE_NOT_SATISFIED:27013,INCORRECT_DATA:27264,NOT_ENOUGH_MEMORY_SPACE:27268,REFERENCED_DATA_NOT_FOUND:27272,FILE_ALREADY_EXISTS:27273,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,CLA_NOT_SUPPORTED:28160,TECHNICAL_PROBLEM:28416,OK:36864,MEMORY_PROBLEM:37440,NO_EF_SELECTED:37888,INVALID_OFFSET:37890,FILE_NOT_FOUND:37892,INCONSISTENT_FILE:37896,ALGORITHM_NOT_SUPPORTED:38020,INVALID_KCV:38021,CODE_NOT_INITIALIZED:38914,ACCESS_CONDITION_NOT_FULFILLED:38916,CONTRADICTION_SECRET_CODE_STATUS:38920,CONTRADICTION_INVALIDATION:38928,CODE_BLOCKED:38976,MAX_VALUE_REACHED:38992,GP_AUTH_FAILED:25344,LICENSING:28482,HALTED:28586};function I(e){this.name="TransportStatusError";var t=Object.keys(m).find((function(t){return m[t]===e}))||"UNKNOWN_ERROR",n=function(e){switch(e){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received"}if(28416<=e&&e<=28671)return"Internal error, please report"}(e)||t,o=e.toString(16);this.message="Ledger device: "+n+" (0x"+o+")",this.stack=(new Error).stack,this.statusCode=e,this.statusText=t}I.prototype=new Error,p("TransportStatusError",(function(e){return new I(e.statusCode)}));var f=n(48764).Buffer;function E(e){const t=f.alloc(2);return t.writeUInt16BE(e,0),t}const T={data:f.alloc(0),dataLength:0,sequence:0},S=(e,t)=>({makeBlocks(n){let o=f.concat([E(n.length),n]);const r=t-5,i=Math.ceil(o.length/r);o=f.concat([o,f.alloc(i*r-o.length+1).fill(0)]);const s=[];for(let t=0;t<i;t++){const n=f.alloc(5);n.writeUInt16BE(e,0),n.writeUInt8(5,2),n.writeUInt16BE(t,3);const i=o.slice(t*r,(t+1)*r);s.push(f.concat([n,i]))}return s},reduceResponse(t,n){let{data:o,dataLength:r,sequence:i}=t||T;if(n.readUInt16BE(0)!==e)throw new v("Invalid channel","InvalidChannel");if(5!==n.readUInt8(2))throw new v("Invalid tag","InvalidTag");if(n.readUInt16BE(3)!==i)throw new v("Invalid sequence","InvalidSequence");t||(r=n.readUInt16BE(5)),i++;const s=n.slice(t?5:7);return o=f.concat([o,s]),o.length>r&&(o=o.slice(0,r)),{data:o,dataLength:r,sequence:i}},getReducedResult(e){if(e&&e.dataLength===e.data.length)return e.data}});var N=n(81249),A=n.n(N);var y;!function(e){e.blue="blue",e.nanoS="nanoS",e.nanoSP="nanoSP",e.nanoX="nanoX",e.stax="stax"}(y||(y={}));const w={[y.blue]:{id:y.blue,productName:"Ledger\xa0Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:491520,masks:[822083584,822149120],getBlockSize:e=>4096},[y.nanoS]:{id:y.nanoS,productName:"Ledger\xa0Nano\xa0S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:327680,masks:[823132160],getBlockSize:e=>{var t;return A().lt(null!==(t=A().coerce(e))&&void 0!==t?t:"","2.0.0")?4096:2048}},[y.nanoSP]:{id:y.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1572864,masks:[856686592],getBlockSize:e=>32},[y.nanoX]:{id:y.nanoX,productName:"Ledger\xa0Nano\xa0X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2097152,masks:[855638016],getBlockSize:e=>4096,bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},[y.stax]:{id:y.stax,productName:"Ledger\xa0Stax",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:1572864,masks:[857735168],getBlockSize:e=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]}},C=(y.blue,y.nanoS,y.nanoSP,y.nanoX,y.stax,Object.values(w)),D=11415,_=e=>{const t=C.find((t=>t.legacyUsbProductId===e));if(t)return t;const n=e>>8;return C.find((e=>e.productIdMM===n))},U=[],P={};for(const e in w){const t=w[e],{bluetoothSpec:n}=t;if(n)for(let e=0;e<n.length;e++){const o=n[e];U.push(o.serviceUuid),P[o.serviceUuid]=P[o.serviceUuid.replace(/-/g,"")]=Object.assign({deviceModel:t},o)}}var b=n(48764).Buffer,O=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{a(o.next(e))}catch(e){i(e)}}function c(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))};const R=[{vendorId:D}],x=()=>{const{hid:e}=navigator;if(!e)throw new i.PS("navigator.hid is not supported","HIDNotSupported");return e};function L(){return O(this,void 0,void 0,(function*(){const e=yield x().requestDevice({filters:R});return Array.isArray(e)?e:[e]}))}function M(){return O(this,void 0,void 0,(function*(){return(yield x().getDevices()).filter((e=>e.vendorId===D))}))}class B extends u{constructor(e){super(),this.channel=Math.floor(65535*Math.random()),this.packetSize=64,this.inputs=[],this.read=()=>this.inputs.length?Promise.resolve(this.inputs.shift()):new Promise((e=>{this.inputCallback=e})),this.onInputReport=e=>{const t=b.from(e.data.buffer);this.inputCallback?(this.inputCallback(t),this.inputCallback=null):this.inputs.push(t)},this._disconnectEmitted=!1,this._emitDisconnect=e=>{this._disconnectEmitted||(this._disconnectEmitted=!0,this.emit("disconnect",e))},this.exchange=e=>O(this,void 0,void 0,(function*(){return yield this.exchangeAtomicImpl((()=>O(this,void 0,void 0,(function*(){const{channel:t,packetSize:n}=this;(0,s.cM)("apdu","=> "+e.toString("hex"));const o=S(t,n),r=o.makeBlocks(e);for(let e=0;e<r.length;e++)yield this.device.sendReport(0,r[e]);let i,c;for(;!(i=o.getReducedResult(c));){const e=yield this.read();c=o.reduceResponse(c,e)}return(0,s.cM)("apdu","<= "+i.toString("hex")),i})))).catch((e=>{if(e&&e.message&&e.message.includes("write"))throw this._emitDisconnect(e),new i.vs(e.message);throw e}))})),this.device=e,this.deviceModel="number"===typeof e.productId?_(e.productId):void 0,e.addEventListener("inputreport",this.onInputReport)}static request(){return O(this,void 0,void 0,(function*(){const[e]=yield L();return B.open(e)}))}static openConnected(){return O(this,void 0,void 0,(function*(){const e=yield M();return 0===e.length?null:B.open(e[0])}))}static open(e){return O(this,void 0,void 0,(function*(){yield e.open();const t=new B(e),n=o=>{e===o.device&&(x().removeEventListener("disconnect",n),t._emitDisconnect(new i.qX))};return x().addEventListener("disconnect",n),t}))}close(){return O(this,void 0,void 0,(function*(){yield this.exchangeBusyPromise,this.device.removeEventListener("inputreport",this.onInputReport),yield this.device.close()}))}setScrambleKey(){}}B.isSupported=()=>Promise.resolve(!(!window.navigator||!window.navigator.hid)),B.list=M,B.listen=e=>{let t=!1;return function(){return O(this,void 0,void 0,(function*(){const e=yield M();return e.length>0?e[0]:(yield L())[0]}))}().then((n=>{if(n){if(!t){const t="number"===typeof n.productId?_(n.productId):void 0;e.next({type:"add",descriptor:n,deviceModel:t}),e.complete()}}else e.error(new i.FB("Access denied to use Ledger device"))}),(t=>{e.error(new i.FB(t.message))})),{unsubscribe:function(){t=!0}}};const k=B},56163:(e,t,n)=>{n.r(t),n.d(t,{LedgerTransport:()=>o,base58check:()=>m,compressPublicKey:()=>g,getExtendedKey:()=>p,getParentFingerprint:()=>v});const o=n(6063).Z;var r=n(40565);const{concat:i,toUtf8Bytes:s,encodeBase58:c,dataSlice:a,toBeHex:d,zeroPadValue:u,ripemd160:l,sha256:h}=r;function p(e,t){const n=g(e),o=v(n);return m(i(["0x0488B21E",d(0),d(o),u(d(0),4),`0x${t}`,n]))}function g(e){if(e.startsWith("02")||e.startsWith("03"))return e;return"0x"+((parseInt(e.slice(-2),16)%2===0?"02":"03")+e.slice(2,66))}function v(e){const t=s(l(h(e)));return(t[0]<<24|t[1]<<16|t[2]<<8|t[3])>>>0}function m(e){return c(i([e,a(h(h(e)),0,4)]))}}}]);